{% extends 'base.html' %}
{% load website_tags %}

{% block content %}
<!-- Hero Section -->
{% get_section 'hero' as hero %}
{% if hero and hero.is_active %}
<section id="hero" class="pt-24 pb-16 bg-gradient-to-r from-primary to-secondary text-white">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
            {% if hero.image %}
            <img src="{{ hero.image.url }}" alt="{{ hero.title }}" class="w-full max-w-2xl mx-auto mb-8 rounded-lg shadow-2xl">
            {% endif %}
            
            <h1 class="text-4xl md:text-6xl font-bold mb-6">{{ hero.title }}</h1>
            
            {% if hero.subtitle %}
            <p class="text-xl md:text-2xl mb-6">{{ hero.subtitle }}</p>
            {% endif %}
            
            {% if hero.description %}
            <p class="text-lg md:text-xl mb-8 text-white/90">{{ hero.description }}</p>
            {% endif %}
            
            <a href="#contacto" class="inline-block px-8 py-4 bg-white text-primary rounded-lg hover:bg-gray-100 transition font-semibold text-lg">
                Cont√°ctanos
            </a>
        </div>
    </div>
</section>
{% else %}
<!-- Hero por defecto si no existe en DB -->
<section id="hero" class="pt-24 pb-16 bg-gradient-to-r from-primary to-secondary text-white">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto text-center">
            <h1 class="text-4xl md:text-6xl font-bold mb-6">
                {% if client.settings.company_name %}
                    {{ client.settings.company_name }}
                {% else %}
                    Bienvenido
                {% endif %}
            </h1>
            <p class="text-xl md:text-2xl mb-8">Soluciones profesionales para tu negocio</p>
            <a href="#contacto" class="inline-block px-8 py-4 bg-white text-primary rounded-lg hover:bg-gray-100 transition font-semibold text-lg">
                Cont√°ctanos
            </a>
        </div>
    </div>
</section>
{% endif %}

<!-- About Section -->
{% get_section 'about' as about %}
{% if about and about.is_active %}
<section id="about" class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">{{ about.title }}</h2>
                
                {% if about.subtitle %}
                <p class="text-xl text-gray-600 mb-6">{{ about.subtitle }}</p>
                {% endif %}
                
                {% if about.description %}
                <div class="text-gray-700 text-lg leading-relaxed">
                    {{ about.description|linebreaks }}
                </div>
                {% endif %}
            </div>
            
            {% if about.image %}
            <div class="mb-8">
                <img src="{{ about.image.url }}" alt="{{ about.title }}" class="w-full max-w-3xl mx-auto rounded-lg shadow-lg">
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% endif %}

<!-- Services Section -->
{% if services %}
<section id="servicios" class="py-16 bg-gray-50">
    <div class="container mx-auto px-4">
        <div class="text-center mb-12">
            <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Nuestros Servicios</h2>
            <p class="text-xl text-gray-600">Soluciones profesionales para tu negocio</p>
        </div>
        
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
            {% for service in services %}
            <div class="bg-white rounded-lg shadow-md p-6 hover:shadow-xl transition">
                {% if service.image %}
                <img src="{{ service.image.url }}" alt="{{ service.name }}" class="w-full h-48 object-cover rounded-lg mb-4">
                {% endif %}
                
                <div class="text-center mb-4">
                    {% if service.icon %}
                    <span class="text-5xl">{{ service.icon }}</span>
                    {% else %}
                    <span class="text-5xl">‚ö°</span>
                    {% endif %}
                </div>
                
                <!-- CORREGIDO: Usar service.name en vez de service.title -->
                <h3 class="text-xl font-bold text-gray-900 mb-3 text-center">{{ service.name }}</h3>
                
                {% if service.description %}
                <div class="text-gray-700 text-sm mb-4 text-center">
                    {{ service.description|truncatewords:30|linebreaks }}
                </div>
                {% endif %}
                
                {% if service.price_text %}
                <p class="text-center text-primary font-semibold text-lg mt-4">{{ service.price_text }}</p>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<!-- Contact Section - SIEMPRE VISIBLE -->
<section id="contacto" class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <div class="max-w-2xl mx-auto">
            <!-- T√≠tulo de la secci√≥n -->
            <div class="text-center mb-12">
                {% get_section 'contact' as contact_section %}
                {% if contact_section %}
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">{{ contact_section.title }}</h2>
                    {% if contact_section.subtitle %}
                    <p class="text-xl text-gray-600 mb-4">{{ contact_section.subtitle }}</p>
                    {% endif %}
                    {% if contact_section.description %}
                    <div class="text-gray-700 mb-6">
                        {{ contact_section.description|linebreaks }}
                    </div>
                    {% endif %}
                {% else %}
                    <!-- T√≠tulo por defecto si no existe secci√≥n en DB -->
                    <h2 class="text-3xl md:text-4xl font-bold text-gray-900 mb-4">Cont√°ctanos</h2>
                    <p class="text-xl text-gray-600 mb-4">¬øTienes alguna pregunta? Escr√≠benos y te responderemos pronto.</p>
                {% endif %}
            </div>
            
            <!-- Formulario de Contacto (SIEMPRE VISIBLE) -->
            <div id="contact-form-container">
                <form method="post" action="{% url 'contact_submit' %}" class="space-y-6 bg-gray-50 p-8 rounded-lg shadow-md">
                    {% csrf_token %}
                    
                    <!-- Nombre -->
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700 mb-2">
                            Nombre <span class="text-red-500">*</span>
                        </label>
                        <input type="text" 
                               id="name" 
                               name="name" 
                               required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition"
                               placeholder="Tu nombre completo">
                    </div>

                    <!-- Email -->
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-2">
                            Email <span class="text-red-500">*</span>
                        </label>
                        <input type="email" 
                               id="email" 
                               name="email" 
                               required
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition"
                               placeholder="tu@email.com">
                    </div>

                    <!-- Tel√©fono -->
                    <div>
                        <label for="phone" class="block text-sm font-medium text-gray-700 mb-2">
                            Tel√©fono
                        </label>
                        <input type="tel" 
                               id="phone" 
                               name="phone"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition"
                               placeholder="+56 9 1234 5678">
                    </div>

                    <!-- Empresa -->
                    <div>
                        <label for="company" class="block text-sm font-medium text-gray-700 mb-2">
                            Empresa
                        </label>
                        <input type="text" 
                               id="company" 
                               name="company"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition"
                               placeholder="Tu empresa (opcional)">
                    </div>

                    <!-- Asunto -->
                    <div>
                        <label for="subject" class="block text-sm font-medium text-gray-700 mb-2">
                            Asunto
                        </label>
                        <input type="text" 
                               id="subject" 
                               name="subject"
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition"
                               placeholder="Asunto del mensaje">
                    </div>

                    <!-- Mensaje -->
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700 mb-2">
                            Mensaje <span class="text-red-500">*</span>
                        </label>
                        <textarea id="message" 
                                  name="message" 
                                  rows="5" 
                                  required
                                  class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent transition"
                                  placeholder="Escribe tu mensaje aqu√≠..."></textarea>
                    </div>

                    <!-- Bot√≥n -->
                    <div>
                        <button type="submit" 
                                class="w-full px-8 py-4 bg-primary text-white rounded-lg hover:bg-secondary transition font-semibold text-lg shadow-md hover:shadow-lg">
                            üìß Enviar Mensaje
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Informaci√≥n de contacto adicional -->
            {% if client.settings %}
            <div class="mt-12 grid md:grid-cols-3 gap-6 text-center">
                {% if client.settings.phone %}
                <div class="p-4">
                    <div class="text-3xl mb-2">üìû</div>
                    <h4 class="font-semibold text-gray-900 mb-1">Tel√©fono</h4>
                    <p class="text-gray-600">{{ client.settings.phone }}</p>
                </div>
                {% endif %}
                
                {% if client.settings.email %}
                <div class="p-4">
                    <div class="text-3xl mb-2">‚úâÔ∏è</div>
                    <h4 class="font-semibold text-gray-900 mb-1">Email</h4>
                    <p class="text-gray-600">{{ client.settings.email }}</p>
                </div>
                {% endif %}
                
                {% if client.settings.address %}
                <div class="p-4">
                    <div class="text-3xl mb-2">üìç</div>
                    <h4 class="font-semibold text-gray-900 mb-1">Direcci√≥n</h4>
                    <p class="text-gray-600">{{ client.settings.address }}</p>
                </div>
                {% endif %}
            </div>
            {% endif %}
        </div>
    </div>
</section>
{% endblock %}